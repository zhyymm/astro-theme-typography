---
const { prev, next, current, total, base } = Astro.props;
if (!total || total <= 1) return null;

const ensureTrailingSlash = (url: string | undefined | null) => {
  if (!url) return null;
  return url.endsWith('/') ? url : `${url}/`;
};

const normalizedBase = base.endsWith('/') ? base : `${base}/`;
const firstPageUrl = normalizedBase;
const lastPageUrl = `${normalizedBase}${total}/`.replace(/\/+/g, '/');

let prevUrl = ensureTrailingSlash(prev);
if (prevUrl && (prevUrl === `${normalizedBase}1/` || prevUrl.endsWith('/1/'))) {
  prevUrl = normalizedBase;
}

const nextUrl = ensureTrailingSlash(next);
---

<nav class="flex flex-col items-start justify-start gap-3 mt-8 mb-12 w-full font-sans" data-pagefind-ignore>
  
  <div class="text-sm text-zinc-500 font-medium tracking-wide ml-1">
    Page {current} <span class="mx-1 opacity-40">/</span> {total}
  </div>

  <div class="inline-flex items-center bg-zinc-100/50 dark:bg-zinc-800/50 p-1 rounded-full border border-zinc-200/50 dark:border-zinc-700/50">

    <div class="flex items-center">
      {current > 1 ? (
        <>
          <a href={firstPageUrl} class="nav-link not-underline-hover">首页</a>
          <a href={prevUrl} class="nav-link px-3 not-underline-hover" title="上一页">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"/></svg>
          </a>
        </>
      ) : (
        <>
          <span class="nav-disabled">首页</span>
          <span class="nav-disabled px-3"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-30" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"/></svg></span>
        </>
      )}
    </div>

    <div class="w-[1px] h-4 bg-zinc-300 dark:bg-zinc-600 mx-1 opacity-50"></div>

    <div class="flex items-center">
      {current < total ? (
        <>
          <a href={nextUrl} class="nav-link px-3 not-underline-hover" title="下一页">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18l6-6l-6-6"/></svg>
          </a>
          <a href={lastPageUrl} class="nav-link not-underline-hover">尾页</a>
        </>
      ) : (
        <>
          <span class="nav-disabled px-3"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-30" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18l6-6l-6-6"/></svg></span>
          <span class="nav-disabled">尾页</span>
        </>
      )}
    </div>
  </div>
</nav>

<style>
  /* 使用标准类名，移除 !important，避免干扰全局 */
  .nav-link {
    @apply px-4 py-1.5 rounded-full text-sm font-medium transition-all flex items-center justify-center;
    color: #52525b; /* zinc-600 */
    text-decoration: none;
  }

  .nav-link:hover {
    background-color: #f4f4f5;
    color: #ea580c; /* 悬停变橙色 */
  }

  .nav-disabled {
    @apply px-4 py-1.5 rounded-full text-sm font-medium text-zinc-300 dark:text-zinc-700 cursor-not-allowed flex items-center justify-center;
  }
</style>