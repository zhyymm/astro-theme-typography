---
const { prev, next, current, total, base } = Astro.props;
if (!total || total <= 1) return null;

const ensureTrailingSlash = (url: string | undefined | null) => {
  if (!url) return null;
  return url.endsWith('/') ? url : `${url}/`;
};

const normalizedBase = base.endsWith('/') ? base : `${base}/`;
const firstPageUrl = normalizedBase;
const lastPageUrl = `${normalizedBase}${total}/`.replace(/\/+/g, '/');

let prevUrl = ensureTrailingSlash(prev);
if (prevUrl && (prevUrl === `${normalizedBase}1/` || prevUrl.endsWith('/1/'))) {
  prevUrl = normalizedBase;
}

const nextUrl = ensureTrailingSlash(next);
---

<nav class="flex flex-col items-start justify-start gap-3 mt-8 mb-12 w-full font-sans" data-pagefind-ignore>
  
  <div class="text-sm text-zinc-500 font-medium tracking-wide ml-1">
    Page {current} <span class="mx-1 opacity-40">/</span> {total}
  </div>

  <div class="inline-flex items-center bg-zinc-100/50 dark:bg-zinc-800/50 p-1 rounded-full border border-zinc-200/50 dark:border-zinc-700/50">

    <div class="flex items-center">
      {current > 1 ? (
        <>
          <a href={firstPageUrl} class="nav-link not-underline-hover">首页</a>
          <a href={prevUrl} class="nav-link px-3 not-underline-hover" title="上一页">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"/></svg>
          </a>
        </>
      ) : (
        <>
          <span class="nav-disabled">首页</span>
          <span class="nav-disabled px-3"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-30" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 18l-6-6l6-6"/></svg></span>
        </>
      )}
    </div>

    <div class="w-[1px] h-4 bg-zinc-300 dark:bg-zinc-600 mx-1 opacity-50"></div>

    <div class="flex items-center">
      {current < total ? (
        <>
          <a href={nextUrl} class="nav-link px-3 not-underline-hover" title="下一页">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18l6-6l-6-6"/></svg>
          </a>
          <a href={lastPageUrl} class="nav-link not-underline-hover">尾页</a>
        </>
      ) : (
        <>
          <span class="nav-disabled px-3"><svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 opacity-30" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18l6-6l-6-6"/></svg></span>
          <span class="nav-disabled">尾页</span>
        </>
      )}
    </div>
  </div>
</nav>

<style is:global>
  /* 1. 保持居中，并缩小与内容的距离 */
  nav[data-pagefind-ignore] {
    display: flex !important;
    justify-content: center !important; /* 核心：保持居中 */
    align-items: left !important;
    gap: 1rem !important;
    
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    
    /* 调节此处数值：1rem 或 1.5rem 通常比较紧凑美观 */
    margin-top: -2.5rem !important; 
    margin-bottom: 0rem !important;
    
    clear: both !important;
  }

  /* 2. 这里的样式确保分页按钮悬停时只有字变色，没有黑色块 */
  nav[data-pagefind-ignore] a {
    color: #71717a !important; 
    transition: color 0.3s ease !important;
    background: transparent !important;
    text-decoration: none !important;
  }

  nav[data-pagefind-ignore] a:hover {
    color: #ea580c !important; /* 悬停变橙 */
    background: transparent !important;
  }

  /* 3. 当前页码数字颜色 */
  nav[data-pagefind-ignore] span {
    color: #18181b !important;
    font-weight: 500 !important;
  }
</style>