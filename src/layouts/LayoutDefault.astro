---
import { themeConfig } from '~/.config'
import SiteFooter from '~/components/SiteFooter.astro'
import SiteNavigation from '~/components/SiteNavigation.astro'
import SiteTitle from '~/components/SiteTitle.astro'
import SiteSeo from '~/components/SiteSeo.astro'
import LaTeX from '~/components/LaTeX.astro'
import Analytics from '~/components/Analytics.astro'
import ThemeScript from '~/components/ThemeScript.astro'
import '~/styles/global.css'

const lang = themeConfig.appearance.locale ?? 'en-us'
const dark = themeConfig.appearance.theme === 'dark'
---

<html lang={lang} class:list={[{ dark }]}>
  <head>
    <slot name="seo"> <SiteSeo /> </slot>
    <LaTeX />
    <Analytics />
    <ThemeScript />
  </head>

  <body
    class="h-100vh max-w-1200px min-w-390px mx-a"
    p="7.5 lg:(y-0 x-20)"
    lg="grid gap-x-6 cols-[3fr_1fr] rows-[1fr_9rem]"
  >
    <header
      class="transition-swup-header flex flex-col gap-2.5"
      m="7.5 lg:(x-0 t-20 b-4)"
      lg="row-1-2 col-2-3 justify-between items-start"
    >
      <SiteTitle />
      <SiteNavigation />
    </header>

    <main class="transition-swup-main overflow-y-scroll scrollbar-hide outline-none" lg="row-1-3 col-1-2 py-20">
      <slot />
    </main>

    <footer class="transition-swup-footer py-7.5" lg="row-2-3 col-2-3">
      <SiteFooter />
    </footer>

    <style is:global>
      /* 1. 核心加固：强制背景透明 (解决服务器端背景发白遮挡网格的问题) */
      html, body, main, header, footer, #swup, section, article {
        background-color: transparent !important;
      }

      /* 2. 背景像素对治：确保网格如实显现 */
      html {
        background-image: url('/placeholder.png') !important;
        background-repeat: repeat !important;
        background-attachment: fixed !important;
        background-size: 960px auto !important;
      }

      /* 3. 针对“已发布文章”那一行的字号补丁 */
      /* 使用属性模糊匹配，避开编译报错，同时能调大字号 */
      [class*="text-[11px]"] {
        font-size: 13px !important; /* 稍微大一点，更清晰 */
        color: #71717a !important; /* 对应的灰色 */
      }

      /* 4. 针对统计行里的数字 */
      [class*="mx-0.5"] {
        font-size: 15px !important;
        font-weight: bold !important;
      }

      /* 5. 针对“查看导师档案”按钮 */
      a[href*="/intro/"] {
        font-size: 13px !important;
        padding: 6px 14px !important;
      }

      /* 6. 隐藏滚动条 */
      .scrollbar-hide::-webkit-scrollbar { display: none; }
      .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>

  </body>

</html>